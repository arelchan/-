<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI模型卡片</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --text-color: #2c3e50;
            --bg-color: #f8f9fa;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            color: var(--text-color);
            background-color: var(--bg-color);
        }

        .model-card {
            max-width: 95%;
            margin: 0.8rem auto;
            padding: 0.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .model-header {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }

        .model-title {
            color: var(--primary-color);
            font-size: 2.2rem;
            font-weight: bold;
        }

        .info-badge {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            margin-right: 0.4rem;
            display: inline-block;
            font-size: 0.9rem;
        }

        .model-intro {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .stage-section {
            margin-bottom: 1.5rem;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }

        .stage-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            cursor: pointer;
        }

        .stage-content {
            padding: 0.75rem;
            width: 100%;
            display: block;
        }

        .metric-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        .metric-table th, .metric-table td {
            padding: 0.5rem;
            border: 1px solid #dee2e6;
            font-size: 0.85rem;
        }

        .metric-table th {
            background-color: #f8f9fa;
        }

        .chart-container {
            width: 100%;
            max-width: 100%;
            min-width: 300px;
            margin: 0.5rem auto;
            height: 350px;
            position: relative;
            background: #fff;
        }

        .radar-chart {
            width: 100%;
            height: 350px;
            position: relative;
        }

        .model-comparison {
            display: flex;
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .model-box {
            flex: 1;
            padding: 1rem;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }

        .model-box h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .metric-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--secondary-color);
        }

        .metric-label {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .chart-placeholder {
            background-color: #f8f9fa;
            border: 1px dashed #dee2e6;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            color: #6c757d;
        }

        /* 模型规格卡片样式 */
        .model-specs .row {
            margin: 0;
        }
        
        .spec-item {
            padding: 0.6rem !important;
            margin-bottom: 0.6rem !important;
            transition: all 0.25s ease;
        }
        
        .spec-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .spec-value {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--secondary-color);
            margin-top: 0.25rem;
        }
        
        .model-capability {
            height: 100%;
            margin-bottom: 0;
        }
        
        .model-capability li {
            padding: 3px 0;
        }
        
        .model-capability i {
            margin-right: 6px;
        }

        /* 水平选项卡样式 */
        .stages-tabs {
            display: flex;
            overflow-x: auto;
            margin-bottom: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 0.5rem;
        }
        
        .stage-tab {
            padding: 0.4rem 0.8rem;
            margin-right: 0.4rem;
            cursor: pointer;
            background-color: #f8f9fa;
            border-radius: 4px 4px 0 0;
            border: 1px solid #dee2e6;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.2s ease-in-out;
        }
        
        .stage-tab:hover {
            background-color: #e9ecef;
            transform: translateY(-2px);
        }
        
        .stage-tab.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(0);
        }
        
        .stage-content {
            display: none;
            transition: opacity 0.3s ease;
            opacity: 0;
        }
        
        .stage-content.active {
            display: block;
            opacity: 1;
        }
        
        /* 两栏布局 */
        .stage-content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.8rem;
        }
        
        @media (max-width: 768px) {
            .stage-content-grid {
                grid-template-columns: 1fr;
            }
            
            .model-card {
                max-width: 95%;
                padding: 0.6rem;
            }
            
            .stages-tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                padding-bottom: 0.4rem;
            }
            
            .stage-tab {
                font-size: 0.8rem;
                padding: 0.3rem 0.6rem;
            }
        }
        
        /* 滚动条美化 */
        .stages-tabs::-webkit-scrollbar {
            height: 4px;
        }
        
        .stages-tabs::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 2px;
        }
        
        .stages-tabs::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 2px;
        }
        
        .stages-tabs::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .version-box {
            margin-bottom: 0.8rem !important;
            padding: 0.8rem !important;
        }
        
        .metric-table {
            margin-bottom: 1rem;
        }
        
        .metric-table th, .metric-table td {
            padding: 0.5rem;
            font-size: 0.85rem;
        }
        
        .p-3 {
            padding: 0.8rem !important;
        }
        
        .mb-3 {
            margin-bottom: 0.8rem !important;
        }

        /* 统一各阶段布局样式 */
        .stage-section-title {
            font-size: 1.2rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
            border-bottom: 2px solid #eee;
            padding-bottom: 0.5rem;
        }
        
        .stage-section-title i {
            margin-right: 0.5rem;
        }
        
        .data-source-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 0.5rem;
            border: 1px solid #dee2e6;
            margin-bottom: 1rem;
            transition: all 0.2s ease;
        }
        
        .data-source-box:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .metric-table tr:nth-child(odd) {
            background-color: rgba(0,0,0,0.02);
        }
        
        .metric-table tr:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        .chart-container {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background: #fff;
            transition: all 0.2s ease;
        }
        
        .chart-container:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .stage-content-section {
            margin-bottom: 1rem;
        }
        
        /* 改进版本概述卡片 */
        .version-box {
            background: linear-gradient(to right, #f8f9fa, #ffffff) !important;
            border-left: 4px solid var(--primary-color) !important;
            transition: all 0.3s ease;
        }
        
        .version-box:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        /* 阶段内容淡入淡出过渡 */
        .stage-content {
            transition: opacity 0.4s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="model-card">
        <!-- 基本信息模块 -->
        <div class="model-header">
            <h1 class="model-title">XunLian-XL-13B</h1>
            <div class="mt-3">
                <span class="info-badge">发布状态：正式发布</span>
                <span class="info-badge">创建时间：2024-03-15</span>
                <span class="info-badge">编辑时间：2024-03-20</span>
                <span class="info-badge">发布时间：2024-03-25</span>
            </div>
            <div class="model-comparison mt-4">
                <div class="model-box">
                    <h4>基座模型</h4>
                    <p>Llama-2-13B</p>
                </div>
                <div class="model-box">
                    <h4>产出模型</h4>
                    <p>XunLian-XL-13B</p>
                </div>
            </div>
        </div>

        <!-- 模型介绍模块 -->
        <div class="model-intro">
            <h2>模型介绍</h2>
            <div class="row">
                <!-- 模型简介 -->
                <div class="col-md-4">
                    <div class="p-3 border rounded bg-light h-100">
                        <h4>模型简介</h4>
                        <p>XunLian-XL-13B是一个基于Llama-2-13B架构开发的大语言模型，经过多阶段优化和训练，在中文理解和生成任务上展现出卓越的性能。该模型在保持原有知识的基础上，通过精心设计的训练策略，显著提升了在特定领域的专业能力。</p>
                        <h5 class="mt-3">主要能力</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success"></i> 优秀的中文理解与生成</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success"></i> 高准确度知识问答</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success"></i> 精确的指令遵循</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success"></i> 代码辅助与分析</li>
                            <li class="mb-2"><i class="bi bi-check-circle-fill text-success"></i> 多轮对话能力</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 模型规格 -->
                <div class="col-md-4">
                    <div class="p-3 border rounded bg-light h-100">
                        <h4>模型规格</h4>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="spec-item p-3 border rounded bg-white mb-3">
                                    <h5><i class="bi bi-cpu"></i> 参数规模</h5>
                                    <div class="spec-value">13B</div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="spec-item p-3 border rounded bg-white mb-3">
                                    <h5><i class="bi bi-text-paragraph"></i> 上下文长度</h5>
                                    <div class="spec-value">4096 tokens</div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="spec-item p-3 border rounded bg-white mb-3">
                                    <h5><i class="bi bi-translate"></i> 支持语言</h5>
                                    <div class="spec-value">中文、英文</div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="spec-item p-3 border rounded bg-white mb-3">
                                    <h5><i class="bi bi-code-square"></i> 基础架构</h5>
                                    <div class="spec-value">Transformer</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 能力雷达图 -->
                <div class="col-md-4">
                    <div class="p-3 border rounded bg-light h-100">
                        <h4 class="text-center mb-3">能力评估</h4>
                        <div id="radarChart" class="radar-chart" style="height: 350px; width: 100%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 各阶段关键信息模块 -->
        <div class="stages-container">
            <!-- 水平选项卡 -->
            <div class="stages-tabs">
                <div class="stage-tab active" data-target="pretrain">1. 预训练阶段</div>
                <div class="stage-tab" data-target="annealing">2. 退火与学习率调整阶段</div>
                <div class="stage-tab" data-target="sft">3. 监督微调(SFT)阶段</div>
                <div class="stage-tab" data-target="rl">4. 偏好对齐/强化学习阶段</div>
                <div class="stage-tab" data-target="distillation">5. 蒸馏与压缩阶段</div>
                <div class="stage-tab" data-target="quantization">6. 量化阶段</div>
                <div class="stage-tab" data-target="optimization">7. 系统优化阶段</div>
                <div class="stage-tab" data-target="evaluation">8. 持续评测阶段</div>
            </div>

            <!-- 预训练阶段 -->
            <div id="pretrain" class="stage-content active">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>XunLian-XL-13B 预训练阶段基于 Llama-2-13B 模型架构，使用了2TB高质量中英文语料进行持续预训练。预训练语料覆盖通用知识、科技文献、代码、数学和多领域专业内容，使用张量并行技术在8×A100 80GB GPU上训练了100k步，有效增强了模型的中文理解和生成能力。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 采用了动态批次调整和梯度累积技术，在有限计算资源下实现了稳定训练。与基础模型相比，中文语义理解能力提升35%，专业领域知识覆盖率提升28%。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/pretrain-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-table"></i> 关键参数</h5>
                            <table class="metric-table">
                                <thead>
                                    <tr>
                                        <th>参数/指标</th>
                                        <th>值</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>模型架构</td>
                                        <td>Transformer</td>
                                    </tr>
                                    <tr>
                                        <td>参数规模</td>
                                        <td>13B</td>
                                    </tr>
                                    <tr>
                                        <td>训练数据集</td>
                                        <td>中英文混合语料库（包含通用知识、科技文献、代码、数学和多领域专业内容）</td>
                                    </tr>
                                    <tr>
                                        <td>训练数据量</td>
                                        <td>2TB</td>
                                    </tr>
                                    <tr>
                                        <td>批次大小</td>
                                        <td>2048</td>
                                    </tr>
                                    <tr>
                                        <td>学习率</td>
                                        <td>1e-4</td>
                                    </tr>
                                    <tr>
                                        <td>训练步数</td>
                                        <td>100k</td>
                                    </tr>
                                    <tr>
                                        <td>GPU资源</td>
                                        <td>8×A100 80GB</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="right-column">
                        <!-- 损失曲线图 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-graph-down"></i> 训练损失曲线</h5>
                            <div id="lossCurve" class="chart-container" style="height: 250px;"></div>
                        </div>
                        
                        <!-- 数据分布部分 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-pie-chart"></i> 训练数据分布</h5>
                            <div class="data-source-box">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="metric-table">
                                            <thead>
                                                <tr>
                                                    <th>数据类型</th>
                                                    <th>占比</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>中文网页</td>
                                                    <td>35%</td>
                                                </tr>
                                                <tr>
                                                    <td>中文书籍</td>
                                                    <td>20%</td>
                                                </tr>
                                                <tr>
                                                    <td>英文网页</td>
                                                    <td>15%</td>
                                                </tr>
                                                <tr>
                                                    <td>英文书籍</td>
                                                    <td>10%</td>
                                                </tr>
                                                <tr>
                                                    <td>代码数据</td>
                                                    <td>15%</td>
                                                </tr>
                                                <tr>
                                                    <td>百科数据</td>
                                                    <td>5%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <div id="pretrainDataPie" style="height: 250px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 退火与学习率调整阶段 -->
            <div id="annealing" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>退火与学习率调整阶段采用余弦退火策略，将学习率从1e-4平滑递减至1e-6，持续了20k步。在退火过程初期，设置了10%的预热比例，避免训练初期的不稳定性。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 通过精心调校的学习率曲线，实现了模型参数的平稳收敛，在最后5k步使用极低学习率进行精调，显著提升了模型的稳定性和泛化能力。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/annealing-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-table"></i> 关键参数</h5>
                            <table class="metric-table">
                                <thead>
                                    <tr>
                                        <th>参数/指标</th>
                                        <th>值</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>退火策略</td>
                                        <td>余弦退火</td>
                                    </tr>
                                    <tr>
                                        <td>起始学习率</td>
                                        <td>1e-4</td>
                                    </tr>
                                    <tr>
                                        <td>结束学习率</td>
                                        <td>1e-6</td>
                                    </tr>
                                    <tr>
                                        <td>退火步数</td>
                                        <td>20k</td>
                                    </tr>
                                    <tr>
                                        <td>预热比例</td>
                                        <td>10%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="right-column">
                        <!-- 损失曲线图 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-graph-down"></i> 学习率变化曲线</h5>
                            <div id="lrCurve" class="chart-container" style="height: 250px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 监督微调(SFT)阶段 -->
            <div id="sft" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>监督微调阶段使用了50万条高质量指令数据进行3轮全参数微调，学习率设置为5e-5，其中30%的数据为领域专业数据。通过精选的微调数据集，模型指令遵循评分从基础模型的65分提升至92分。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 采用低秩适应(LoRA)技术进行初始微调，再转为全参数微调，有效平衡了训练效率和效果。人工评估显示多轮对话能力和复杂指令理解能力显著提升。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/sft-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <!-- 数据分布部分 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-pie-chart"></i> 指令数据分布</h5>
                            <div class="data-source-box">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="metric-table">
                                            <thead>
                                                <tr>
                                                    <th>数据类型</th>
                                                    <th>占比</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>通用对话</td>
                                                    <td>40%</td>
                                                </tr>
                                                <tr>
                                                    <td>知识问答</td>
                                                    <td>25%</td>
                                                </tr>
                                                <tr>
                                                    <td>创意写作</td>
                                                    <td>15%</td>
                                                </tr>
                                                <tr>
                                                    <td>代码与编程</td>
                                                    <td>10%</td>
                                                </tr>
                                                <tr>
                                                    <td>专业领域</td>
                                                    <td>10%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <div id="sftDataPie" style="height: 250px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- SFT参数表格 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-table"></i> 关键参数</h5>
                            <table class="metric-table">
                                <thead>
                                    <tr>
                                        <th>参数/指标</th>
                                        <th>值</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>指令数据集</td>
                                        <td>高质量中英文指令数据集</td>
                                    </tr>
                                    <tr>
                                        <td>指令数据量</td>
                                        <td>50万条</td>
                                    </tr>
                                    <tr>
                                        <td>微调轮次</td>
                                        <td>3轮</td>
                                    </tr>
                                    <tr>
                                        <td>微调学习率</td>
                                        <td>5e-5</td>
                                    </tr>
                                    <tr>
                                        <td>微调批次大小</td>
                                        <td>128</td>
                                    </tr>
                                    <tr>
                                        <td>领域适配比例</td>
                                        <td>30%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="right-column">
                        <!-- 指令遵循评分对比图 -->
                        <div id="instructionChart" class="chart-container" style="height: 250px;"></div>
                    </div>
                </div>
            </div>

            <!-- 偏好对齐/强化学习阶段 -->
            <div id="rl" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>偏好对齐/强化学习阶段采用PPO算法，使用基于RoBERTa-large的奖励模型对10万条人类偏好数据进行强化学习。KL系数设置为0.1，确保模型保持对SFT阶段学到的知识，同时向人类偏好方向优化。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 实现了多维度奖励函数设计，不仅考虑回答质量，还包括安全性、无害性和实用性，使模型输出更符合人类预期且更为安全可控。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/rl-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <!-- 数据分布部分 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-pie-chart"></i> 偏好数据分布</h5>
                            <div class="data-source-box">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="metric-table">
                                            <thead>
                                                <tr>
                                                    <th>数据类型</th>
                                                    <th>占比</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>有害请求拒绝</td>
                                                    <td>30%</td>
                                                </tr>
                                                <tr>
                                                    <td>事实性对比</td>
                                                    <td>25%</td>
                                                </tr>
                                                <tr>
                                                    <td>回答质量</td>
                                                    <td>20%</td>
                                                </tr>
                                                <tr>
                                                    <td>指令理解</td>
                                                    <td>15%</td>
                                                </tr>
                                                <tr>
                                                    <td>公平性与偏见</td>
                                                    <td>10%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <div id="rlDataPie" style="height: 250px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- RL参数表格 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-table"></i> 关键参数</h5>
                            <table class="metric-table">
                                <thead>
                                    <tr>
                                        <th>参数/指标</th>
                                        <th>值</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>RL算法</td>
                                        <td>PPO</td>
                                    </tr>
                                    <tr>
                                        <td>奖励模型</td>
                                        <td>RoBERTa-large</td>
                                    </tr>
                                    <tr>
                                        <td>人类偏好数据</td>
                                        <td>10万条</td>
                                    </tr>
                                    <tr>
                                        <td>KL系数</td>
                                        <td>0.1</td>
                                    </tr>
                                    <tr>
                                        <td>偏好数据量</td>
                                        <td>10万条</td>
                                    </tr>
                                    <tr>
                                        <td>奖励模型精度</td>
                                        <td>88.5%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="right-column">
                        <!-- 奖励分布图 -->
                        <div class="stage-content-section">
                            <h5 class="stage-section-title"><i class="bi bi-bar-chart"></i> 奖励分布</h5>
                            <div id="rewardChart" class="chart-container" style="height: 250px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 蒸馏与压缩阶段 -->
            <div id="distillation" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>蒸馏与压缩阶段使用XunLian-XL-13B作为教师模型，训练了参数量为7B的XunLian-S-7B学生模型。蒸馏温度设置为2.0，在保留95%性能的同时，实现了参数量的大幅压缩。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 采用渐进式多任务蒸馏策略，首先学习教师模型的特征表示，再模仿输出分布，最后针对特定任务进行专项优化，确保小模型在关键能力上的保留率。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/distillation-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <table class="metric-table">
                            <thead>
                                <tr>
                                    <th>参数/指标</th>
                                    <th>值</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>教师模型</td>
                                    <td>XunLian-XL-13B</td>
                                </tr>
                                <tr>
                                    <td>学生模型</td>
                                    <td>XunLian-S-7B</td>
                                </tr>
                                <tr>
                                    <td>蒸馏温度</td>
                                    <td>2.0</td>
                                </tr>
                                <tr>
                                    <td>性能保留率</td>
                                    <td>95%</td>
                                </tr>
                                <tr>
                                    <td>参数压缩比</td>
                                    <td>1:4</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="right-column">
                        <!-- 蒸馏前后性能对比图 -->
                        <div id="distillationChart" class="chart-container" style="height: 250px;"></div>
                    </div>
                </div>
            </div>

            <!-- 量化阶段 -->
            <div id="quantization" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>量化阶段采用后训练量化(PTQ)方法将模型权重转换为INT8位宽，使用10k样本校准，精度损失控制在1%以内。量化后的模型大小减少75%，推理速度提升2.5倍，同时保持了接近原始模型的性能表现。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 实现了层级自适应量化策略，对注意力层和FFN层使用不同的量化参数，针对关键层使用更高精度量化，平衡了性能和效率。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/quantization-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <table class="metric-table">
                            <thead>
                                <tr>
                                    <th>参数/指标</th>
                                    <th>值</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>量化方法</td>
                                    <td>PTQ</td>
                                </tr>
                                <tr>
                                    <td>位宽</td>
                                    <td>INT8</td>
                                </tr>
                                <tr>
                                    <td>精度损失</td>
                                    <td><1%</td>
                                </tr>
                                <tr>
                                    <td>校准数据集</td>
                                    <td>10k样本</td>
                                </tr>
                                <tr>
                                    <td>加速比</td>
                                    <td>2.5x</td>
                                </tr>
                                <tr>
                                    <td>内存节省</td>
                                    <td>75%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="right-column">
                        <!-- 量化效果对比图 -->
                        <div id="quantizationChart" class="chart-container" style="height: 250px;"></div>
                    </div>
                </div>
            </div>

            <!-- 系统优化阶段 -->
            <div id="optimization" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>系统优化阶段使用TensorRT作为推理引擎，采用张量并行技术进行多设备部署。启用KV缓存机制显著提升了推理效率，实现32的批处理能力，平均延迟控制在50ms，吞吐量达到100 QPS。</p>
                            <p class="mb-0"><strong>关键优化：</strong> 通过内存优化和计算图优化，峰值内存控制在40GB以内，同时实现了动态批处理和推理长度自适应，使系统在各种负载下都能保持高效运行。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/optimization-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整训练报告
                                </a>
                            </div>
                        </div>
                        
                        <table class="metric-table">
                            <thead>
                                <tr>
                                    <th>参数/指标</th>
                                    <th>值</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>推理引擎</td>
                                    <td>TensorRT</td>
                                </tr>
                                <tr>
                                    <td>并行策略</td>
                                    <td>张量并行</td>
                                </tr>
                                <tr>
                                    <td>KV缓存</td>
                                    <td>启用</td>
                                </tr>
                                <tr>
                                    <td>批处理能力</td>
                                    <td>32</td>
                                </tr>
                                <tr>
                                    <td>延迟指标</td>
                                    <td>50ms</td>
                                </tr>
                                <tr>
                                    <td>吞吐量</td>
                                    <td>100 QPS</td>
                                </tr>
                                <tr>
                                    <td>峰值内存</td>
                                    <td>40GB</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="right-column">
                        <!-- 系统性能指标图 -->
                        <div id="performanceChart" class="chart-container" style="height: 250px;"></div>
                    </div>
                </div>
            </div>

            <!-- 持续评测阶段 -->
            <div id="evaluation" class="stage-content">
                <div class="stage-content-grid">
                    <div class="left-column">
                        <!-- 总结部分 -->
                        <div class="version-box mb-3 p-3 bg-light rounded border">
                            <h4><i class="bi bi-info-circle"></i> 总结</h4>
                            <p>持续评测阶段使用了MMLU、GSM8K、BBH等多个基准测试套件，同时进行了医疗、法律、金融等领域专项测试。XunLian-XL-13B在MMLU上得分85.3，GSM8K上82.1，人类评估平均分4.5/5。</p>
                            <p class="mb-0"><strong>关键发现：</strong> 与基线模型Llama-2-13B相比，在中文理解和生成能力上有显著提升，特别在多轮对话、专业领域问答和指令遵循上表现突出，同时成功通过了所有红队测试。</p>
                            <div class="text-end mt-3">
                                <a href="/reports/evaluation-report-13b.html" class="btn btn-sm btn-outline-secondary" target="_blank">
                                    <i class="bi bi-file-text"></i> 查看完整评测报告
                                </a>
                            </div>
                        </div>
                        
                        <!-- 模型对比部分 -->
                        <div class="model-comparison-box mt-3">
                            <h4>与主流模型对比</h4>
                            <div class="table-responsive">
                                <table class="metric-table">
                                    <thead>
                                        <tr>
                                            <th>模型</th>
                                            <th>MMLU</th>
                                            <th>GSM8K</th>
                                            <th>BBH</th>
                                            <th>C-Eval</th>
                                            <th>CMMLU</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>XunLian-XL-13B</strong></td>
                                            <td>85.3</td>
                                            <td>82.1</td>
                                            <td>78.5</td>
                                            <td>83.7</td>
                                            <td>84.2</td>
                                        </tr>
                                        <tr>
                                            <td>Llama-2-13B</td>
                                            <td>68.5</td>
                                            <td>56.2</td>
                                            <td>48.3</td>
                                            <td>51.2</td>
                                            <td>50.8</td>
                                        </tr>
                                        <tr>
                                            <td>Qwen-14B</td>
                                            <td>76.8</td>
                                            <td>73.4</td>
                                            <td>64.7</td>
                                            <td>80.5</td>
                                            <td>79.3</td>
                                        </tr>
                                        <tr>
                                            <td>Baichuan2-13B</td>
                                            <td>72.3</td>
                                            <td>65.6</td>
                                            <td>55.2</td>
                                            <td>78.4</td>
                                            <td>81.2</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 主流模型对比柱状图 -->
                        <div id="modelComparisonChart" class="chart-container" style="height: 500px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 初始化所有图表
        function initCharts() {
            // 确保所有图表容器都存在
            const chartContainers = {
                'radarChart': document.getElementById('radarChart'),
                'lossCurve': document.getElementById('lossCurve'),
                'lrCurve': document.getElementById('lrCurve'),
                'instructionChart': document.getElementById('instructionChart'),
                'rewardChart': document.getElementById('rewardChart'),
                'distillationChart': document.getElementById('distillationChart'),
                'quantizationChart': document.getElementById('quantizationChart'),
                'performanceChart': document.getElementById('performanceChart'),
                'pretrainDataPie': document.getElementById('pretrainDataPie'),
                'sftDataPie': document.getElementById('sftDataPie'),
                'rlDataPie': document.getElementById('rlDataPie'),
                'modelComparisonChart': document.getElementById('modelComparisonChart')
            };

            // 检查容器是否存在
            for (const [id, container] of Object.entries(chartContainers)) {
                if (!container) {
                    console.error(`图表容器 ${id} 未找到`);
                    continue;
                }
                
                // 设置容器样式
                container.style.width = '100%';
                container.style.height = id === 'radarChart' ? '350px' : '300px';
                
                // 初始化图表
                const chart = echarts.init(container, null, {
                    renderer: 'canvas',
                    animation: true,
                    animationDuration: 500,
                    animationEasing: 'cubicOut'
                });
                
                // 根据ID设置不同的图表配置
                let option = {};
                switch(id) {
                    case 'radarChart':
                        option = {
                            animation: true,
                            title: {
                                text: '模型能力评估',
                                left: 'center',
                                top: 10
                            },
                            tooltip: {
                                trigger: 'item'
                            },
                            legend: {
                                data: ['XunLian-XL-13B'],
                                bottom: 5
                            },
                            radar: {
                                indicator: [
                                    { name: '语言理解', max: 100 },
                                    { name: '数学能力', max: 100 },
                                    { name: '代码能力', max: 100 },
                                    { name: '知识广度', max: 100 },
                                    { name: '推理能力', max: 100 }
                                ],
                                radius: '65%',
                                center: ['50%', '55%']
                            },
                            series: [{
                                type: 'radar',
                                data: [{
                                    value: [90, 85, 88, 92, 87],
                                    name: 'XunLian-XL-13B',
                                    areaStyle: {
                                        opacity: 0.3
                                    }
                                }]
                            }]
                        };
                        break;
                    case 'lossCurve':
                        option = {
                            title: { 
                                text: '训练损失曲线',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'axis'
                            },
                            grid: {
                                left: 60,
                                right: 60,
                                bottom: 60,
                                top: 60,
                                containLabel: true
                            },
                            xAxis: { 
                                type: 'category',
                                data: ['0', '10k', '20k', '30k', '40k', '50k', '60k', '70k', '80k', '90k', '100k'],
                                name: '训练步数',
                                nameLocation: 'middle',
                                nameGap: 30
                            },
                            yAxis: { 
                                type: 'value',
                                name: '损失值',
                                nameLocation: 'middle',
                                nameGap: 50,
                                min: 2,
                                max: 5
                            },
                            series: [{
                                data: [4.5, 3.8, 3.2, 2.8, 2.5, 2.3, 2.25, 2.22, 2.21, 2.20, 2.19],
                                type: 'line',
                                smooth: true,
                                lineStyle: {
                                    width: 3
                                },
                                areaStyle: {
                                    opacity: 0.3
                                }
                            }]
                        };
                        break;
                    case 'lrCurve':
                        option = {
                            title: { 
                                text: '学习率变化曲线',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'axis'
                            },
                            grid: {
                                left: 60,
                                right: 60,
                                bottom: 60,
                                top: 60,
                                containLabel: true
                            },
                            xAxis: { 
                                type: 'category',
                                data: ['0', '2k', '4k', '6k', '8k', '10k', '12k', '14k', '16k', '18k', '20k'],
                                name: '训练步数',
                                nameLocation: 'middle',
                                nameGap: 30
                            },
                            yAxis: { 
                                type: 'log',
                                logBase: 10,
                                name: '学习率',
                                nameLocation: 'middle',
                                nameGap: 50,
                                min: 1e-6,
                                max: 1e-4
                            },
                            series: [{
                                data: [1e-4, 9e-5, 8e-5, 7e-5, 6e-5, 5e-5, 4e-5, 3e-5, 2e-5, 1.5e-5, 1e-6],
                                type: 'line',
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                areaStyle: {
                                    opacity: 0.3
                                }
                            }]
                        };
                        break;
                    case 'instructionChart':
                        option = {
                            title: { 
                                text: '指令遵循评分对比',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'axis'
                            },
                            grid: {
                                left: 60,
                                right: 60,
                                bottom: 60,
                                top: 60,
                                containLabel: true
                            },
                            xAxis: { 
                                type: 'category',
                                data: ['基础模型', 'SFT后', 'RL后'],
                                name: '训练阶段',
                                nameLocation: 'middle',
                                nameGap: 30
                            },
                            yAxis: { 
                                type: 'value',
                                max: 100,
                                min: 0,
                                name: '评分',
                                nameLocation: 'middle',
                                nameGap: 50
                            },
                            series: [{
                                data: [65, 85, 92],
                                type: 'bar',
                                barWidth: '40%',
                                itemStyle: {
                                    borderRadius: [4, 4, 0, 0],
                                    color: '#2ecc71'
                                }
                            }]
                        };
                        break;
                    case 'rewardChart':
                        option = {
                            title: { 
                                text: '奖励分布',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'axis',
                                formatter: function(params) {
                                    return `${params[0].name}<br/>样本数: ${params[0].value}`;
                                }
                            },
                            grid: {
                                left: 60,
                                right: 60,
                                bottom: 60,
                                top: 60,
                                containLabel: true
                            },
                            xAxis: { 
                                type: 'category',
                                data: ['0-20', '20-40', '40-60', '60-80', '80-100'],
                                name: '奖励区间',
                                nameLocation: 'middle',
                                nameGap: 30
                            },
                            yAxis: { 
                                type: 'value',
                                name: '样本数量',
                                nameLocation: 'middle',
                                nameGap: 50
                            },
                            series: [{
                                data: [5, 15, 40, 30, 10],
                                type: 'bar',
                                barWidth: '40%',
                                itemStyle: {
                                    borderRadius: [4, 4, 0, 0],
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        { offset: 0, color: '#e74c3c' },
                                        { offset: 1, color: '#c0392b' }
                                    ])
                                }
                            }]
                        };
                        break;
                    case 'distillationChart':
                        option = {
                            title: { 
                                text: '蒸馏前后性能对比',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'item'
                            },
                            legend: {
                                data: ['蒸馏前', '蒸馏后'],
                                bottom: 10
                            },
                            radar: {
                                indicator: [
                                    { name: '准确率', max: 100 },
                                    { name: '推理速度', max: 100 },
                                    { name: '内存占用', max: 100 }
                                ],
                                radius: '65%',
                                center: ['50%', '55%'],
                                splitNumber: 4
                            },
                            series: [{
                                type: 'radar',
                                data: [
                                    { 
                                        value: [95, 90, 85],
                                        name: '蒸馏前',
                                        areaStyle: {
                                            opacity: 0.3,
                                            color: '#3498db'
                                        },
                                        lineStyle: {
                                            color: '#3498db'
                                        }
                                    },
                                    { 
                                        value: [92, 95, 75],
                                        name: '蒸馏后',
                                        areaStyle: {
                                            opacity: 0.3,
                                            color: '#2ecc71'
                                        },
                                        lineStyle: {
                                            color: '#2ecc71'
                                        }
                                    }
                                ]
                            }]
                        };
                        break;
                    case 'quantizationChart':
                        option = {
                            title: { 
                                text: '量化效果对比',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'axis',
                                formatter: function(params) {
                                    return `${params[0].name}<br/>大小: ${params[0].value}GB`;
                                }
                            },
                            grid: {
                                left: 60,
                                right: 60,
                                bottom: 60,
                                top: 60,
                                containLabel: true
                            },
                            xAxis: { 
                                type: 'category',
                                data: ['原始模型', 'INT8量化', 'INT4量化'],
                                name: '模型版本',
                                nameLocation: 'middle',
                                nameGap: 30
                            },
                            yAxis: { 
                                type: 'value',
                                name: '模型大小(GB)',
                                nameLocation: 'middle',
                                nameGap: 50,
                                min: 0,
                                max: 30
                            },
                            series: [{
                                name: '模型大小',
                                type: 'bar',
                                data: [26, 6.5, 3.25],
                                barWidth: '40%',
                                itemStyle: {
                                    borderRadius: [4, 4, 0, 0],
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        { offset: 0, color: '#9b59b6' },
                                        { offset: 1, color: '#8e44ad' }
                                    ])
                                }
                            }]
                        };
                        break;
                    case 'performanceChart':
                        option = {
                            title: { 
                                text: '系统性能指标',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'item'
                            },
                            legend: {
                                data: ['优化后'],
                                bottom: 10
                            },
                            radar: {
                                indicator: [
                                    { name: '吞吐量', max: 100 },
                                    { name: '延迟', max: 100 },
                                    { name: '内存效率', max: 100 },
                                    { name: 'GPU利用率', max: 100 }
                                ],
                                radius: '65%',
                                center: ['50%', '55%'],
                                splitNumber: 4
                            },
                            series: [{
                                type: 'radar',
                                data: [{
                                    value: [90, 85, 88, 92],
                                    name: '优化后',
                                    areaStyle: {
                                        opacity: 0.3,
                                        color: '#f1c40f'
                                    },
                                    lineStyle: {
                                        color: '#f1c40f'
                                    }
                                }]
                            }]
                        };
                        break;
                    case 'pretrainDataPie':
                        option = {
                            title: {
                                text: '预训练数据分布',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: '{a} <br/>{b}: {c} ({d}%)'
                            },
                            legend: {
                                orient: 'vertical',
                                left: 10,
                                top: 'center',
                                data: ['中文网页', '中文书籍', '英文网页', '英文书籍', '代码数据', '百科数据']
                            },
                            series: [
                                {
                                    name: '数据来源',
                                    type: 'pie',
                                    radius: ['40%', '70%'],
                                    center: ['60%', '55%'],
                                    avoidLabelOverlap: false,
                                    itemStyle: {
                                        borderRadius: 10,
                                        borderColor: '#fff',
                                        borderWidth: 2
                                    },
                                    label: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        label: {
                                            show: true,
                                            fontSize: 16,
                                            fontWeight: 'bold'
                                        }
                                    },
                                    labelLine: {
                                        show: false
                                    },
                                    data: [
                                        { value: 35, name: '中文网页' },
                                        { value: 20, name: '中文书籍' },
                                        { value: 15, name: '英文网页' },
                                        { value: 10, name: '英文书籍' },
                                        { value: 15, name: '代码数据' },
                                        { value: 5, name: '百科数据' }
                                    ],
                                    colorBy: 'data'
                                }
                            ]
                        };
                        break;
                    case 'sftDataPie':
                        option = {
                            title: {
                                text: '指令数据分布',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: '{a} <br/>{b}: {c} ({d}%)'
                            },
                            legend: {
                                orient: 'vertical',
                                left: 10,
                                top: 'center',
                                data: ['通用对话', '知识问答', '创意写作', '代码与编程', '专业领域']
                            },
                            series: [
                                {
                                    name: '数据来源',
                                    type: 'pie',
                                    radius: ['40%', '70%'],
                                    center: ['60%', '55%'],
                                    avoidLabelOverlap: false,
                                    itemStyle: {
                                        borderRadius: 10,
                                        borderColor: '#fff',
                                        borderWidth: 2
                                    },
                                    label: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        label: {
                                            show: true,
                                            fontSize: 16,
                                            fontWeight: 'bold'
                                        }
                                    },
                                    labelLine: {
                                        show: false
                                    },
                                    data: [
                                        { value: 40, name: '通用对话' },
                                        { value: 25, name: '知识问答' },
                                        { value: 15, name: '创意写作' },
                                        { value: 10, name: '代码与编程' },
                                        { value: 10, name: '专业领域' }
                                    ],
                                    colorBy: 'data'
                                }
                            ]
                        };
                        break;
                    case 'rlDataPie':
                        option = {
                            title: {
                                text: '偏好数据分布',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: '{a} <br/>{b}: {c} ({d}%)'
                            },
                            legend: {
                                orient: 'vertical',
                                left: 10,
                                top: 'center',
                                data: ['有害请求拒绝', '事实性对比', '回答质量', '指令理解', '公平性与偏见']
                            },
                            series: [
                                {
                                    name: '数据来源',
                                    type: 'pie',
                                    radius: ['40%', '70%'],
                                    center: ['60%', '55%'],
                                    avoidLabelOverlap: false,
                                    itemStyle: {
                                        borderRadius: 10,
                                        borderColor: '#fff',
                                        borderWidth: 2
                                    },
                                    label: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        label: {
                                            show: true,
                                            fontSize: 16,
                                            fontWeight: 'bold'
                                        }
                                    },
                                    labelLine: {
                                        show: false
                                    },
                                    data: [
                                        { value: 30, name: '有害请求拒绝' },
                                        { value: 25, name: '事实性对比' },
                                        { value: 20, name: '回答质量' },
                                        { value: 15, name: '指令理解' },
                                        { value: 10, name: '公平性与偏见' }
                                    ],
                                    colorBy: 'data'
                                }
                            ]
                        };
                        break;
                    case 'modelComparisonChart':
                        option = {
                            title: {
                                text: '主流模型对比',
                                left: 'center',
                                top: 20
                            },
                            tooltip: {
                                trigger: 'axis',
                                axisPointer: {
                                    type: 'shadow'
                                }
                            },
                            legend: {
                                data: ['XunLian-XL-13B', 'Llama-2-13B', 'Qwen-14B', 'Baichuan2-13B'],
                                bottom: 10
                            },
                            grid: {
                                left: 60,
                                right: 60,
                                bottom: 60,
                                top: 60,
                                containLabel: true
                            },
                            xAxis: [
                                {
                                    type: 'category',
                                    data: ['MMLU', 'GSM8K', 'BBH', 'C-Eval', 'CMMLU'],
                                    axisLabel: {
                                        interval: 0
                                    }
                                }
                            ],
                            yAxis: [
                                {
                                    type: 'value',
                                    name: '分数',
                                    min: 0,
                                    max: 100,
                                    interval: 20
                                }
                            ],
                            series: [
                                {
                                    name: 'XunLian-XL-13B',
                                    type: 'bar',
                                    emphasis: {
                                        focus: 'series'
                                    },
                                    data: [85.3, 82.1, 78.5, 83.7, 84.2],
                                    itemStyle: {
                                        color: '#3498db'
                                    }
                                },
                                {
                                    name: 'Llama-2-13B',
                                    type: 'bar',
                                    emphasis: {
                                        focus: 'series'
                                    },
                                    data: [68.5, 56.2, 48.3, 51.2, 50.8],
                                    itemStyle: {
                                        color: '#2ecc71'
                                    }
                                },
                                {
                                    name: 'Qwen-14B',
                                    type: 'bar',
                                    emphasis: {
                                        focus: 'series'
                                    },
                                    data: [76.8, 73.4, 64.7, 80.5, 79.3],
                                    itemStyle: {
                                        color: '#e74c3c'
                                    }
                                },
                                {
                                    name: 'Baichuan2-13B',
                                    type: 'bar',
                                    emphasis: {
                                        focus: 'series'
                                    },
                                    data: [72.3, 65.6, 55.2, 78.4, 81.2],
                                    itemStyle: {
                                        color: '#9b59b6'
                                    }
                                }
                            ]
                        };
                        break;
                }
                
                // 设置图表配置
                chart.setOption(option);
                // 保存图表实例
                window[`${id}Instance`] = chart;
            }
        }

        // 页面加载完成后初始化图表和选项卡功能
        document.addEventListener('DOMContentLoaded', function() {
            // 先初始化所有图表
            initCharts();

            // 添加选项卡切换功能
            const stageTabs = document.querySelectorAll('.stage-tab');
            const stageContents = document.querySelectorAll('.stage-content');
            
            // 定义每个选项卡对应的图表ID
            const tabChartMap = {
                'pretrain': ['lossCurve', 'pretrainDataPie'],
                'annealing': ['lrCurve'],
                'sft': ['instructionChart', 'sftDataPie'],
                'rl': ['rewardChart', 'rlDataPie'],
                'distillation': ['distillationChart'],
                'quantization': ['quantizationChart'],
                'optimization': ['performanceChart'],
                'evaluation': ['modelComparisonChart']
            };
            
            // 定义选项卡切换函数
            function switchTab(tabElement) {
                // 如果当前标签已经处于激活状态，则不执行切换
                if (tabElement.classList.contains('active')) {
                    return;
                }
                
                // 移除所有激活状态
                stageTabs.forEach(t => t.classList.remove('active'));
                
                // 找到当前活跃内容
                const activeContent = document.querySelector('.stage-content.active');
                const targetId = tabElement.getAttribute('data-target');
                const targetContent = document.getElementById(targetId);
                
                // 添加当前标签的激活状态
                tabElement.classList.add('active');
                
                if (activeContent) {
                    // 淡出当前内容
                    activeContent.style.opacity = '0';
                    
                    // 等待淡出完成后切换
                    setTimeout(() => {
                        // 隐藏当前内容并显示目标内容
                        activeContent.classList.remove('active');
                        targetContent.classList.add('active');
                        targetContent.style.opacity = '0';
                        
                        // 淡入新内容
                        setTimeout(() => {
                            targetContent.style.opacity = '1';
                            
                            // 调整图表大小
                            const chartIds = tabChartMap[targetId] || [];
                            chartIds.forEach(id => {
                                if (window[`${id}Instance`]) {
                                    window[`${id}Instance`].resize();
                                }
                            });
                        }, 50);
                    }, 200);
                } else {
                    // 初始状态，直接显示
                    targetContent.classList.add('active');
                    targetContent.style.opacity = '1';
                    
                    // 调整图表大小
                    const chartIds = tabChartMap[targetId] || [];
                    chartIds.forEach(id => {
                        if (window[`${id}Instance`]) {
                            window[`${id}Instance`].resize();
                        }
                    });
                }
            }
            
            // 为每个选项卡添加点击事件
            stageTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this);
                });
            });

            // 窗口调整大小时重新调整图表
            let resizeTimer;
            window.addEventListener('resize', function() {
                // 使用节流函数，避免频繁调整
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    // 重新调整所有当前可见图表
                    const activeTab = document.querySelector('.stage-tab.active');
                    if (activeTab) {
                        const targetId = activeTab.getAttribute('data-target');
                        const chartIds = tabChartMap[targetId] || [];
                        chartIds.forEach(id => {
                            if (window[`${id}Instance`]) {
                                window[`${id}Instance`].resize();
                            }
                        });
                    }
                    
                    // 调整雷达图大小
                    if (window['radarChartInstance']) {
                        window['radarChartInstance'].resize();
                    }
                }, 200);
            });
        });
    </script>
</body>
</html>